<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0, viewport-fit=cover" />
  <title>MR Studio Minimalist</title>

  <style>
    :root{
      /* Paleta Minimalista B&W */
      --bg-app: #111111;
      --bg-panel: #1e1e1e;
      --border: #333333;
      --text-main: #ffffff;
      --text-muted: #888888;
      
      --accent-active: #ffffff; /* Blanco puro para activos */
      --text-active: #000000;   /* Negro puro para texto activo */
      
      --accent-select: #FF5500; /* Naranja fuerte para selecci√≥n 3D */
    }

    body {
      margin: 0; background: var(--bg-app); overflow: hidden;
      font-family: 'Helvetica Neue', Arial, sans-serif;
      -webkit-user-select: none; user-select: none; touch-action: none;
      color: var(--text-main);
    }

    /* --- OVERLAY --- */
    #overlay{
      position: absolute; inset: 0;
      display: flex; flex-direction: column;
      align-items: center; justify-content: center;
      background: var(--bg-app); z-index: 999;
      transition: opacity .35s ease;
    }
    h1 { font-size: 24px; font-weight: 300; letter-spacing: 2px; text-transform: uppercase; margin-bottom: 20px; }
    p { font-size: 12px; color: var(--text-muted); margin-bottom: 40px; }

    button.start-btn {
      padding: 14px 40px; border: 1px solid var(--text-main);
      background: transparent; color: var(--text-main);
      font-size: 14px; letter-spacing: 1px; text-transform: uppercase;
      cursor: pointer; transition: 0.2s;
    }
    button.start-btn:active { background: var(--text-main); color: var(--bg-app); }

    /* --- TOP BARS (Render & Camera) --- */
    #render-bar, #camera-bar {
      position: absolute; left: 50%; transform: translateX(-50%);
      display: flex; gap: 8px;
      padding: 6px 10px; border-radius: 4px;
      background: var(--bg-panel); border: 1px solid var(--border);
      z-index: 120;
    }
    #render-bar { top: calc(20px + env(safe-area-inset-top)); }
    #camera-bar { top: calc(70px + env(safe-area-inset-top)); }

    .render-opt, .cam-opt, .icon-btn {
      background: transparent; border: 1px solid transparent;
      color: var(--text-muted); font-size: 11px; font-weight: 600; text-transform: uppercase;
      padding: 6px 10px; border-radius: 2px; cursor: pointer; transition: 0.2s;
    }
    .icon-btn { font-size: 16px; padding: 2px 10px; }
    
    .render-opt.active, .cam-opt.active, .icon-btn:active {
      background: var(--accent-active); color: var(--text-active);
    }
    .icon-btn[disabled] { opacity: 0.2; pointer-events: none; }

    /* --- UTILITY BUTTONS --- */
    #exit-manipulation {
      position: absolute; top: calc(20px + env(safe-area-inset-top)); right: 20px;
      width: 40px; height: 40px; border: 1px solid var(--border);
      background: var(--bg-panel); color: var(--text-main);
      font-size: 16px; cursor: pointer; display: none;
      align-items: center; justify-content: center; z-index: 160;
    }
    #exit-manipulation.visible { display: flex; }
    #exit-manipulation:active { background: #FF3333; border-color: #FF3333; }

    #space-toggle {
      position: absolute; top: calc(120px + env(safe-area-inset-top)); left: 50%; transform: translateX(-50%);
      padding: 6px 12px; background: var(--bg-panel); border: 1px solid var(--border);
      color: var(--text-muted); font-size: 10px; text-transform: uppercase; letter-spacing: 1px;
      display: none; align-items: center; gap: 6px; z-index: 160; cursor: pointer;
    }
    #space-toggle.visible { display: flex; }
    #space-toggle.local { border-color: var(--accent-active); color: var(--accent-active); }

    #edit-values-btn {
      position: absolute; width: 44px; height: 44px;
      background: var(--bg-panel); border: 1px solid var(--text-main);
      color: var(--text-main); font-size: 18px;
      display: none; align-items: center; justify-content: center;
      z-index: 200; cursor: pointer;
    }
    #edit-values-btn.visible { display: flex; }
    #edit-values-btn:active { background: var(--text-main); color: var(--bg-app); }

    /* --- SUBTOOLBAR (Subcomponents) --- */
    #subtoolbar-container {
      position: absolute; bottom: calc(100px + env(safe-area-inset-bottom));
      left: 0; right: 0; display: flex; justify-content: center;
      pointer-events: none; z-index: 150;
    }
    #subtoolbar {
      pointer-events: auto; display: none; gap: 1px;
      background: var(--border); border: 1px solid var(--border);
    }
    #subtoolbar.visible { display: flex; }

    .sub-btn {
      height: 36px; padding: 0 16px; border: none;
      background: var(--bg-panel); color: var(--text-muted);
      font-size: 11px; font-weight: 700; text-transform: uppercase;
      cursor: pointer; display: flex; align-items: center; gap: 6px; transition: 0.2s;
    }
    .sub-btn.active { background: var(--accent-active); color: var(--text-active); }
    .sub-btn.explode.active { background: #FF3333; color: white; }

    /* --- MAIN TOOLBAR --- */
    #toolbar-container {
      position: absolute; bottom: calc(30px + env(safe-area-inset-bottom));
      left: 0; right: 0; display: flex; justify-content: center;
      pointer-events: none; z-index: 140;
    }
    #toolbar {
      pointer-events: auto; display: flex; gap: 1px;
      background: var(--border); border: 1px solid var(--border);
      overflow-x: auto;
    }
    .tool-btn {
      width: 60px; height: 50px; border: none;
      background: var(--bg-panel); color: var(--text-muted);
      font-size: 20px; display: flex; flex-direction: column;
      align-items: center; justify-content: center; cursor: pointer; transition: 0.2s;
    }
    .tool-btn .label { font-size: 8px; margin-top: 4px; text-transform: uppercase; font-weight: 600; opacity: 0.6; }
    .tool-btn.active { background: var(--accent-active); color: var(--text-active); }
    .tool-btn:active { background: #333; color: white; }
    
    .divider { width: 1px; background: var(--bg-app); }

    /* --- DIALOGS (Confirm & Axis) --- */
    #confirm-dialog {
      position: absolute; bottom: calc(150px + env(safe-area-inset-bottom));
      left: 50%; transform: translateX(-50%);
      display: none; gap: 10px; padding: 8px;
      background: var(--bg-panel); border: 1px solid var(--border);
      z-index: 210;
    }
    #confirm-dialog.visible { display: flex; }
    .mini-btn {
      width: 44px; height: 44px; border: none;
      font-size: 18px; color: white; cursor: pointer;
    }
    .mini-btn.cancel { background: #333; }
    .mini-btn.ok { background: var(--accent-active); color: black; }

    #axis-input-dialog {
      position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
      display: none; z-index: 260; width: 280px; padding: 20px;
      background: var(--bg-panel); border: 1px solid var(--border);
      box-shadow: 0 20px 50px rgba(0,0,0,0.8);
    }
    #axis-input-dialog.visible { display: block; }
    #axis-input-dialog h3 { margin: 0 0 15px 0; text-align: center; font-size: 14px; text-transform: uppercase; }
    .input-row { display: flex; gap: 10px; margin-bottom: 10px; align-items: center; }
    .input-label { font-size: 10px; font-weight: bold; width: 15px; }
    .axis-input-field {
      flex: 1; background: #111; border: 1px solid #333;
      color: white; padding: 8px; font-family: monospace; text-align: center;
    }
    .buttons { display: flex; gap: 10px; margin-top: 20px; }
    .btn-apply, .btn-cancel {
      flex: 1; padding: 10px; border: none; cursor: pointer; font-size: 12px; font-weight: bold; text-transform: uppercase;
    }
    .btn-apply { background: var(--accent-active); color: black; }
    .btn-cancel { background: #333; color: white; }

    /* --- MEASUREMENT & CAMERA PANEL --- */
    #distance-label {
      position: absolute; background: black; color: white; border: 1px solid #333;
      padding: 4px 8px; font-size: 10px; font-family: monospace;
      opacity: 0; z-index: 170; pointer-events: none;
    }
    #distance-label.visible { opacity: 1; }

    #edit-cam-panel {
      position: absolute; right: 10px; top: 50%; transform: translateY(-50%);
      display: none; flex-direction: column; gap: 10px; z-index: 220;
    }
    #edit-cam-panel.visible { display: flex; }
    .camlock-btn {
      width: 44px; height: 44px; background: var(--bg-panel); border: 1px solid var(--border);
      color: var(--text-muted); font-size: 18px; cursor: pointer;
    }
    .camlock-btn.active { background: var(--accent-active); color: black; border-color: white; }
  </style>

  <script type="importmap">
  {
    "imports": {
      "three": "https://cdn.jsdelivr.net/npm/three@0.170.0/build/three.module.js",
      "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.170.0/examples/jsm/"
    }
  }
  </script>
</head>

<body>

  <div id="overlay">
    <h1>MR Studio</h1>
    <p>Minimalist Edition</p>
    <div style="display:none" id="theme-selector"></div> <button class="start-btn" id="btn-start">Iniciar Sesi√≥n de Dise√±o</button>
  </div>

  <div id="render-bar">
    <button class="render-opt active" data-render="flat">Flat</button>
    <button class="render-opt" data-render="clay">Clay</button>
    <button class="render-opt" data-render="tech">Tech</button>
  </div>

  <div id="camera-bar">
    <button class="icon-btn" id="btn-undo" title="Undo" disabled>‚ü≤</button>
    <button class="icon-btn" id="btn-redo" title="Redo" disabled>‚ü≥</button>
    <button class="cam-opt" data-cam="focus">Focus</button>
    <button class="cam-opt" data-cam="iso">Iso</button>
    <button class="cam-opt" data-cam="top">Top</button>
  </div>

  <button id="exit-manipulation">‚úï</button>

  <button id="space-toggle">
    <span id="space-icon">üåç</span>
    <span id="space-text">Global</span>
  </button>

  <button id="edit-values-btn">‚úé</button>

  <div id="edit-cam-panel">
    <button class="camlock-btn" id="btn-cam-zoom">üîç</button>
    <button class="camlock-btn" id="btn-cam-orbit">‚óØ</button>
  </div>

  <svg id="measurement-line" width="100%" height="100%" style="position:absolute; inset:0; pointer-events:none; opacity:0;">
    <line id="measure-line" x1="0" y1="0" x2="0" y2="0" stroke="#FFFFFF" stroke-width="1" stroke-dasharray="4,4" />
    <circle id="origin-dot" cx="0" cy="0" r="3" fill="#FF5500" />
  </svg>
  <div id="distance-label">0.00 m</div>

  <div id="confirm-dialog">
    <button class="mini-btn cancel" id="btn-cancel">‚úï</button>
    <button class="mini-btn ok" id="btn-ok">‚úì</button>
  </div>

  <div id="axis-input-dialog">
    <h3 id="axis-title">Input</h3>
    <div class="axis-name" id="axis-subtitle" style="display:none;"></div>
    <div class="input-row"><div class="input-label">X</div><input type="number" id="input-x" class="axis-input-field" step="0.1"/></div>
    <div class="input-row"><div class="input-label">Y</div><input type="number" id="input-y" class="axis-input-field" step="0.1"/></div>
    <div class="input-row"><div class="input-label">Z</div><input type="number" id="input-z" class="axis-input-field" step="0.1"/></div>
    <div class="buttons">
      <button class="btn-apply" id="btn-apply">Aplicar</button>
      <button class="btn-cancel" id="btn-close">Cancelar</button>
    </div>
  </div>

  <div id="subtoolbar-container">
    <div id="subtoolbar">
      <button class="sub-btn" id="sub-verts">V√©rtices</button>
      <button class="sub-btn" id="sub-edges">Bordes</button>
      <button class="sub-btn" id="sub-faces">Caras</button>
      <button class="sub-btn explode" id="sub-explode">Explode</button>
      <button class="sub-btn" id="sub-clear">‚úï</button>
    </div>
  </div>

  <div id="toolbar-container">
    <div id="toolbar">
      <button class="tool-btn" data-spawn="box">‚ñ°<span class="label">Box</span></button>
      <button class="tool-btn" data-spawn="sphere">‚óã<span class="label">Esfera</span></button>
      <button class="tool-btn" data-spawn="cylinder">‚åº<span class="label">Cil</span></button>
      <div class="divider"></div>
      <button class="tool-btn active" id="btn-move" data-mode="translate">‚Üî<span class="label">Mover</span></button>
      <button class="tool-btn" id="btn-rot" data-mode="rotate">‚Üª<span class="label">Rotar</span></button>
      <button class="tool-btn" id="btn-scale" data-mode="scale">‚§¢<span class="label">Escala</span></button>
      <button class="tool-btn" id="btn-select" data-mode="select">‚ãÆ<span class="label">Sub</span></button>
      <div class="divider"></div>
      <button class="tool-btn" id="btn-delete">‚úï<span class="label">Borrar</span></button>
      <button class="tool-btn" id="btn-color">‚óë<span class="label">Color</span></button>
    </div>
  </div>

  <div id="theme-light" style="display:none;"></div>
  <div id="theme-dark" style="display:none;"></div>

  <script type="module" src="./editor-core.js"></script>
</body>
</html>
